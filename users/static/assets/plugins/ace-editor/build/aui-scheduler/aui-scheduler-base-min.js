AUI.add("aui-scheduler-base",function(ad){var Q=ad.Lang,ax=Q.isString,a=Q.isArray,e=Q.isDate,ar=Q.isFunction,J=Q.isNumber,C=Q.isObject,I=function(A){return(A instanceof ad.Scheduler);},t=function(A){return(A instanceof ad.SchedulerView);},ab=function(A){return(A instanceof ad.SchedulerEvent);},u=function(A){return(ad.SchedulerCalendar&&(A instanceof ad.SchedulerCalendar));},i=ad.DataType.DateMath,X=ad.WidgetStdMod,V=".",p="",q=" ",s="scheduler-base",aj="data-view-name",G="activeView",aw="clearfix",F="controls",al="controlsNode",ao="current",ac="currentDate",Z="currentDateNode",ak="date",ah="endDate",ai="eventClass",O="eventRecorder",ay="events",aD="hd",w="header",av="headerNode",n="helper",T="icon",k="iconNextNode",aq="iconPrevNode",aB="locale",m="name",R="nav",N="navNode",b="navigationDateFormatter",o="next",d="nextDate",au="prev",am="prevDate",aC="rendered",M="scheduler",az="startDate",E="strings",f="today",ae="todayNode",v="triggerNode",z="view",P="viewStack",aE="views",Y="viewsNode",B=ad.getClassName,af=B(n,aw),j=B(T),ap=B(s,F),U=B(s,ao,ak),g=B(s,aD),W=B(s,T,o),D=B(s,T,au),aA=B(s,R),y=B(s,f),aa=B(s,z),h=B(s,z,p),r=B(s,aE),an='<div class="'+ap+'"></div>',x='<div class="'+U+'"></div>',c='<div class="'+g+'"></div>',aF='<a href="#" class="'+[j,W].join(q)+'">Next</a>',ag='<a href="#" class="'+[j,D].join(q)+'">Prev</a>',l='<div class="'+aA+'"></div>',S='<a href="#" class="'+y+'">{today}</a>',at='<a href="#" class="'+[aa,h].join(q)+'{name}" data-view-name="{name}">{label}</a>',K='<div class="'+r+'"></div>';var L=function(){};L.ATTRS={eventClass:{valueFn:function(){return ad.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ad.mix(L.prototype,{addEvent:function(aG){var A=this;var aH=A.get(ay);if(ad.Array.indexOf(aH,aG)>-1){ad.Array.removeItem(aH,aG);}aH.push(aG);A.set(ay,aH);},addEvents:function(aG){var A=this;ad.Array.each(A._normalizeEvents(aG),ad.bind(A.addEvent,A));},eachEvent:function(aH){var A=this;var aG=A.get(ay);ad.Array.each(aG,aH,A);},removeEvent:function(aG){var A=this;var aH=A.get(ay);if(aH.length){ad.Array.removeItem(aH,aG);A.set(ay,aH);}},removeEvents:function(aG){var A=this;ad.Array.each(A._normalizeEvents(aG),ad.bind(A.removeEvent,A));},_normalizeEvents:function(aH){var A=this;var aG=[];aH=ad.Array(aH);ad.Array.each(aH,function(aI){if(ab(aI)){aG.push(aI);}else{if(u(aI)){if(I(A)){aI.set(M,A);}aG=aG.concat(A._normalizeEvents(aI.get(ay)));}else{aI=new (A.get(ai))(aI);aG.push(aI);}}if(I(A)){aI.set(M,A);aI.set(ai,A.get(ai));}});return aG;},_setEvents:function(aG){var A=this;return A._normalizeEvents(aG);}});ad.SchedulerEventSupport=L;var H=ad.Component.create({NAME:s,ATTRS:{activeView:{validator:t},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aG){var A=this;return ad.DataType.Date.format(aG,{format:"%B %d, %Y",locale:A.get(aB)});},validator:ar},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:e},firstDayOfWeek:{value:0,validator:J},controlsNode:{valueFn:function(){return ad.Node.create(an);}},currentDateNode:{valueFn:function(){return ad.Node.create(x);}},headerNode:{valueFn:function(){return ad.Node.create(c);}},iconNextNode:{valueFn:function(){return ad.Node.create(aF);}},iconPrevNode:{valueFn:function(){return ad.Node.create(ag);}},navNode:{valueFn:function(){return ad.Node.create(l);}},todayNode:{valueFn:function(){return ad.Node.create(this._processTemplate(S));}},viewsNode:{valueFn:function(){return ad.Node.create(K);}}},HTML_PARSER:{controlsNode:V+ap,currentDateNode:V+U,headerNode:V+g,iconNextNode:V+W,iconPrevNode:V+D,navNode:V+aA,todayNode:V+y,viewsNode:V+r},UI_ATTRS:[ac],AUGMENTS:[ad.SchedulerEventSupport,ad.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[P]={};A[al]=A.get(al);A[Z]=A.get(Z);A[w]=A.get(av);A[k]=A.get(k);A[aq]=A.get(aq);A[N]=A.get(N);A[ae]=A.get(ae);A[Y]=A.get(Y);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ad.Array.each(A.get(ay),function(aG){aG.eachRepeatedEvent(function(aH){delete aH._filtered;});delete aG._filtered;});},getEventsByDay:function(aG,aH){var A=this;aG=i.safeClearTime(aG);return A._getEvents(aG,function(aI){return i.compare(aI.getClearStartDate(),aG)||(aH&&i.compare(aI.getClearEndDate(),aG));});},getIntersectEvents:function(aG){var A=this;aG=i.safeClearTime(aG);return A._getEvents(aG,function(aI){var aH=aI.getClearStartDate();var aJ=aI.getClearEndDate();return(i.compare(aG,aH)||i.compare(aG,aJ)||i.between(aG,aH,aJ));});},sortEventsByDateAsc:function(aG){var A=this;aG.sort(function(aK,aI){var aJ=aK.get(ah);var aH=aI.get(ah);var aM=aK.get(az);var aL=aI.get(az);if(i.after(aM,aL)||(i.compare(aM,aL)&&i.before(aJ,aH))){return 1;}else{return -1;}});},getViewByName:function(aG){var A=this;return A[P][aG];},getStrings:function(){var A=this;return A.get(E);},getString:function(aG){var A=this;return A.getStrings()[aG];},renderView:function(aG){var A=this;if(aG){aG.show();if(!aG.get(aC)){if(!A.bodyNode){A.setStdModContent(X.BODY,p);}aG.render(A.bodyNode);}}},plotViewEvents:function(aG){var A=this;aG.plotEvents(A.get(ay));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(G));},_afterActiveViewChange:function(aI){var aG=this;if(aG.get(aC)){var aH=aI.newVal;var A=aI.prevVal;if(A){A.hide();}aG.renderView(aH);var aJ=aG.get(O);if(aJ){aJ.hideOverlay();}}},_afterRender:function(aG){var A=this;A.renderView(A.get(G));},_bindDelegate:function(){var A=this;A[Y].delegate("click",A._onClickViewTrigger,V+aa,A);A[al].delegate("click",A._onClickPrevIcon,V+D,A);A[al].delegate("click",A._onClickNextIcon,V+W,A);A[al].delegate("click",A._onClickToday,V+y,A);},_createViewTriggerNode:function(aG){var A=this;if(!aG.get(v)){var aH=aG.get(m);aG.set(v,ad.Node.create(Q.sub(at,{name:aH,label:(A.getString(aH)||aH)})));
}return aG.get(v);},_getEvents:function(aG,aJ){var A=this;var aI=A.get(ay);var aH=[];ad.Array.each(aI,function(aK){if(aJ.apply(A,[aK])){aH.push(aK);}else{if(aK.isRepeatableDate(aG)){var aL=aK.repeatByDate(aG);aH.push(aL);}}});A.sortEventsByDateAsc(aH);return aH;},_onClickToday:function(aG){var A=this;A.set(ac,A.get(G).getToday());aG.preventDefault();},_onClickNextIcon:function(aG){var A=this;A.set(ac,A.get(G).get(d));aG.preventDefault();},_onClickPrevIcon:function(aG){var A=this;A.set(ac,A.get(G).get(am));aG.preventDefault();},_onClickViewTrigger:function(aG){var A=this;var aH=aG.currentTarget.attr(aj);A.set(G,A.getViewByName(aH));aG.preventDefault();},_processTemplate:function(aG){var A=this;return Q.sub(aG,A.getStrings());},_setEventRecorder:function(aG){var A=this;if(aG){aG.set(M,A);aG.set(ai,A.get(ai));}},_setViews:function(aH){var A=this;var aG=[];ad.Array.each(aH,function(aI){if(t(aI)&&!aI.get(aC)){aI.set(M,A);aI.set(ai,A.get(ai));aG.push(aI);A[P][aI.get(m)]=aI;}});if(!A.get(G)){A.set(G,aH[0]);}return aG;},syncStdContent:function(){var A=this;var aG=A.get(aE);A[N].append(A[aq]);A[N].append(A[k]);A[al].append(A[ae]);A[al].append(A[N]);A[al].append(A[Z]);ad.Array.each(aG,function(aH){A[Y].append(A._createViewTriggerNode(aH));});A[w].append(A[al]);A[w].append(A[Y]);A[w].addClass(af);A.setStdModContent(X.HEADER,A[w].getDOM());},_uiSetCurrentDate:function(aJ){var aG=this;var aI=aG.get(b);var A=aI.call(aG,aJ);if(aG.get(aC)){var aH=aG.get(G);if(aH){aH._uiSetCurrentDate(aJ);aI=aH.get(b);A=aI.call(aH,aJ);}aG[Z].html(A);aG.syncEventsUI();}}}});ad.Scheduler=H;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});