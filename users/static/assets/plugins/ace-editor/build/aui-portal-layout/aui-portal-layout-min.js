AUI.add("aui-portal-layout",function(x){var au=x.Lang,Z=au.isBoolean,z=au.isFunction,ad=au.isObject,o=au.isString,i=au.isValue,p=au.toInt,P=Math.ceil,g=x.DD.DDM,w="append",ar="circle",n="portlet-column",aa="portlet-boundary",S="delegateConfig",G=".",Q="down",H="drag",k="dragNode",l="dragNodes",C="dropContainer",u="dropNodes",ag="groups",V="icon",b="indicator",m="l",D="lazyStart",M="left",T="marginBottom",r="marginTop",aq="node",ae="offsetHeight",af="offsetWidth",ac="placeAfter",q="placeBefore",v="placeholder",ap="portal-layout",y="prepend",at="proxy",ai="proxyNode",h="r",O="region",ak="right",a=" ",U="target",an="triangle",E="up",s="placeholderAlign",W="quadrantEnter",t="quadrantExit",am="quadrantOver",ao=0,ab=0,B=0,f=0,F=function(A){return(A instanceof x.NodeList);},N=function(){return Array.prototype.slice.call(arguments).join(a);},c=function(A){return F(A)?A:x.all(A);},Y=function(L,A){return p(L.getStyle(A));},j=x.getClassName,K=j(ap,H,b),J=j(ap,H,b,V),ah=j(ap,H,b,V,M),e=j(ap,H,b,V,ak),d=j(ap,H,U,b),aj=j(V),av=j(V,ar,an,m),al=j(V,ar,an,h),I='<div class="'+K+'">'+'<div class="'+N(J,ah,aj,al)+'"></div>'+'<div class="'+N(J,e,aj,av)+'"></div>'+"<div>";var X=x.Component.create({NAME:ap,ATTRS:{delegateConfig:{value:null,setter:function(R){var A=this;var L=x.merge({bubbleTargets:A,dragConfig:{},nodes:A.get(l),target:true},R);x.mix(L.dragConfig,{groups:A.get(ag),startCentered:true});return L;},validator:ad},proxyNode:{setter:function(A){return o(A)?x.Node.create(A):A;}},dragNodes:{validator:o},dropContainer:{value:function(A){return A;},validator:z},dropNodes:{setter:"_setDropNodes"},groups:{value:[ap]},lazyStart:{value:false,validator:Z},placeholder:{value:I,setter:function(L){var A=o(L)?x.Node.create(L):L;if(!A.inDoc()){x.getBody().prepend(A.hide());}ao=Y(A,T);ab=Y(A,r);A.addClass(d);B=Y(A,T);f=Y(A,r);return A;}},proxy:{value:null,setter:function(R){var A=this;var L={moveOnEnd:false,positionProxy:false};if(A.get(ai)){L.borderStyle=null;}return x.merge(L,R||{});}}},EXTENDS:x.Base,prototype:{initializer:function(){var A=this;A.bindUI();},bindUI:function(){var A=this;A.publish(s,{defaultFn:A._defPlaceholderAlign,queuable:false,emitFacade:true,bubbles:true});A._bindDDEvents();A._bindDropZones();},addDropNode:function(R,L){var A=this;R=x.one(R);if(!g.getDrop(R)){A.addDropTarget(new x.DD.Drop(x.merge({bubbleTargets:A,groups:A.get(ag),node:R},L)));}},addDropTarget:function(L){var A=this;L.addToGroup(A.get(ag));},alignPlaceholder:function(R,L){var A=this;var aw=A.get(v);if(!A.lazyEvents){aw.show();}A._syncPlaceholderSize();aw.setXY(A.getPlaceholderXY(R,L));},calculateDirections:function(R){var L=this;var aw=L.lastY;var ax=L.lastX;var A=R.lastXY[0];var ay=R.lastXY[1];if(A!=ax){L.XDirection=(A<ax)?M:ak;}if(ay!=aw){L.YDirection=(ay<aw)?E:Q;}L.lastX=A;L.lastY=ay;},calculateQuadrant:function(aD,L){var aH=this;var ay=1;var aG=L.get(aq);var aF=aG.get(O);var aC=aD.mouseXY;var ax=aC[0];var aw=aC[1];var aE=aF.top;var R=aF.left;if(aG.hasClass(n)){var az=aG.all(G+aa);if(!az.isEmpty()){var aB=az.item(az.size()-1);aF.bottom=aB.get(O).bottom;}else{aF.bottom=aE;}}var A=aE+(aF.bottom-aE)/2;var aA=R+(aF.right-R)/2;if(aw<A){ay=(ax>aA)?1:2;}else{ay=(ax<aA)?3:4;}aH.quadrant=ay;return ay;},getPlaceholderXY:function(az,L){var aD=this;var aC=aD.get(v);var ax=ao;var A=ab;if(L){ax=B;A=f;}aC.toggleClass(d,L);var aw=P(az.bottom);var R=P(az.left);var aB=P(az.top);var aA=R;var ay=(aD.quadrant<3)?(aB-(aC.get(ae)+ax)):(aw+A);return[aA,ay];},removeDropTarget:function(L){var A=this;L.removeFromGroup(A.get(ag));},_alignCondition:function(){var A=this;var ax=g.activeDrag;var R=A.activeDrop;if(ax&&R){var aw=ax.get(aq);var L=R.get(aq);return !aw.contains(L);}return true;},_bindDDEvents:function(){var A=this;var L=A.get(S);var R=A.get(at);A.delegate=new x.DD.Delegate(L);A.delegate.dd.plug(x.Plugin.DDProxy,R);A.on("drag:end",x.bind(A._onDragEnd,A));A.on("drag:enter",x.bind(A._onDragEnter,A));A.on("drag:exit",x.bind(A._onDragExit,A));A.on("drag:over",x.bind(A._onDragOver,A));A.on("drag:start",x.bind(A._onDragStart,A));A.after("drag:start",x.bind(A._afterDragStart,A));A.on(W,A._syncPlaceholderUI);A.on(t,A._syncPlaceholderUI);},_bindDropZones:function(){var A=this;var L=A.get(u);if(L){L.each(function(aw,R){A.addDropNode(aw);});}},_defPlaceholderAlign:function(ax){var A=this;var R=A.activeDrop;var ay=A.get(v);if(R&&ay){var aw=R.get("node");var L=!!aw.drop;A.lastAlignDrop=R;A.alignPlaceholder(R.get(aq).get(O),L);}},_evOutput:function(){var A=this;return{drag:g.activeDrag,drop:A.activeDrop,quadrant:A.quadrant,XDirection:A.XDirection,YDirection:A.YDirection};},_fireQuadrantEvents:function(){var A=this;var aw=A._evOutput();var R=A.lastQuadrant;var L=A.quadrant;if(L!=R){if(R){A.fire(t,x.merge({lastDrag:A.lastDrag,lastDrop:A.lastDrop,lastQuadrant:A.lastQuadrant,lastXDirection:A.lastXDirection,lastYDirection:A.lastYDirection},aw));}A.fire(W,aw);}A.fire(am,aw);A.lastDrag=g.activeDrag;A.lastDrop=A.activeDrop;A.lastQuadrant=L;A.lastXDirection=A.XDirection;A.lastYDirection=A.YDirection;},_getAppendNode:function(){return g.activeDrag.get(aq);},_positionNode:function(ax){var A=this;var aw=A.lastAlignDrop||A.activeDrop;if(aw){var az=A._getAppendNode();var L=aw.get(aq);var R=i(L.drop);var ay=(A.quadrant<3);if(A._alignCondition()){if(R){L[ay?q:ac](az);}else{var aA=A.get(C).apply(A,[L]);aA[ay?y:w](az);}}}},_syncPlaceholderUI:function(L){var A=this;if(A._alignCondition()){A.fire(s,{drop:A.activeDrop,originalEvent:L});}},_syncPlaceholderSize:function(){var A=this;var L=A.activeDrop.get(aq);var R=A.get(v);if(R){R.set(af,L.get(af));}},_syncProxyNodeUI:function(R){var A=this;var aw=g.activeDrag.get(k);var L=A.get(ai);if(L&&!L.compareTo(aw)){aw.append(L);A._syncProxyNodeSize();}},_syncProxyNodeSize:function(){var A=this;var R=g.activeDrag.get(aq);var L=A.get(ai);if(R&&L){L.set(ae,R.get(ae));L.set(af,R.get(af));}},_afterDragStart:function(L){var A=this;if(A.get(at)){A._syncProxyNodeUI(L);}},_onDragEnd:function(R){var A=this;var aw=A.get(v);var L=A.get(ai);if(!A.lazyEvents){A._positionNode(R);
}if(L){L.remove();}if(aw){aw.hide();}A.lastQuadrant=null;A.lastXDirection=null;A.lastYDirection=null;},_onDragEnter:function(L){var A=this;A.activeDrop=g.activeDrop;if(A.lazyEvents&&A.lastActiveDrop){A.lazyEvents=false;A._syncPlaceholderUI(L);}if(!A.lastActiveDrop){A.lastActiveDrop=g.activeDrop;}},_onDragExit:function(L){var A=this;A._syncPlaceholderUI(L);A.activeDrop=g.activeDrop;A.lastActiveDrop=g.activeDrop;},_onDragOver:function(R){var A=this;var L=R.drag;if(A.activeDrop==g.activeDrop){A.calculateDirections(L);A.calculateQuadrant(L,A.activeDrop);A._fireQuadrantEvents();}},_onDragStart:function(L){var A=this;if(A.get(D)){A.lazyEvents=true;}A.lastActiveDrop=null;A.activeDrop=g.activeDrop;},_setDropNodes:function(L){var A=this;if(z(L)){L=L.call(A);}return c(L);}}});x.PortalLayout=X;},"@VERSION@",{skinnable:true,requires:["aui-base","dd-drag","dd-delegate","dd-drop","dd-proxy"]});