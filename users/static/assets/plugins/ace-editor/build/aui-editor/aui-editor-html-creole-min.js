AUI.add("aui-editor-html-creole",function(d){var j=d.Lang;var p="\n";var h="**";var n="//";var c="ol";var a="#";var b="p";var g="pre";var f="ul";var k="*";var l=/^h([1-6])$/i;var i=/(\r?\n\s*)$/;var e=/[^\t\n\r ]/;var m=" ";var o=d.Component.create({NAME:"domparsercreole",ATTRS:{data:{value:null,validator:j.isString}},EXTENDS:d.Base,prototype:{_endResult:null,_inPRE:false,_ulLevel:0,initializer:function(){},convert:function(t){var q=this;if(t){this.set("data",t);}else{t=this.get("data");}var s=d.config.doc.createElement("div");s.innerHTML=t;q._handle(s);var r=q._endResult.join("");q._endResult=null;return r;},_isAllWS:function(q){return q.isElementContentWhitespace||!(e.test(q.data));},_isDataAvailable:function(){var q=this;return q._endResult&&q._endResult.length;},_isIgnorable:function(s){var q=this;var r=s.nodeType;return(s.isElementContentWhitespace||r==8)||((r==3)&&q._isAllWS(s));},_isLastItemNewLine:function(s){var q=this;var r=q._endResult;return(r&&i.test(r.slice(-1)));},_handle:function(v){var B=this;var s,t,x,y,z,A,r,w,q,u;if(!j.isArray(B._endResult)){B._endResult=[];}t=v.childNodes;u=B._pushTagList;r=t.length;for(y=0;y<r;y++){z=[];A=[];w=[];q=[];s=t[y];if(B._isIgnorable(s)&&!B._inPRE){continue;}B._handleElementStart(s,z,A);B._handleStyles(s,w,q);u.call(B,z);u.call(B,w);B._handle(s);B._handleElementEnd(s,z,A);u.call(B,q.reverse());u.call(B,A);}x=v.data;B._handleData(x,v);},_handleData:function(s,r){var q=this;if(j.isValue(s)){q._endResult.push(s);}},_handleElementStart:function(u,s,r){var q=this;var t=u.tagName;var v;if(t){t=t.toLowerCase();if(t==b){q._handleParagraph(u,s,r);}else{if(t=="br"){q._handleBreak(u,s,r);}else{if(t=="a"){q._handleLink(u,s,r);}else{if(t=="strong"||t=="b"){q._handleStrong(u,s,r);}else{if(t=="em"||t=="i"){q._handleEm(u,s,r);}else{if(t=="img"){q._handleImage(u,s,r);}else{if(t==f){q._handleUnorderedList(u,s,r);}else{if(t=="li"){q._handleListItem(u,s,r);}else{if(t==c){q._handleOrderedList(u,s,r);}else{if(t=="hr"){q._handleHr(u,s,r);}else{if(t==g){q._handlePre(u,s,r);}else{if((v=l.exec(t))){q._handleHeader(u,s,r,v);}else{if(t=="th"){q._handleTableHeader(u,s,r);}else{if(t=="tr"){q._handleTableRow(u,s,r);}else{if(t=="td"){q._handleTableCell(u,s,r);}}}}}}}}}}}}}}}}},_handleElementEnd:function(u,s,r){var q=this;var t=u.tagName;if(t){t=t.toLowerCase();}if(t==b){if(!q._isLastItemNewLine()){q._endResult.push(p);}}else{if(t==f||t==c){q._ulLevel-=1;if(!q._isLastItemNewLine()){q._endResult.push(p);}}else{if(t==g){if(!q._isLastItemNewLine()){q._endResult.push(p);}q._inPRE=false;}else{if(t=="table"){r.push(p);}}}}},_handleBreak:function(t,s,r){var q=this;if(q._inPRE){s.push(p);}else{s.push("\\\\");}},_handleEm:function(s,r,q){r.push(n);q.push(n);},_handleHeader:function(u,s,r,v){var q=this;var t=new Array(parseInt(v[1],10)+1);t=t.join("=");if(q._isDataAvailable()&&!q._isLastItemNewLine()){s.push(p);}s.push(t,m);r.push(m,t,p);},_handleHr:function(t,s,r){var q=this;if(q._isDataAvailable()&&!q._isLastItemNewLine()){s.push(p);}s.push("----",p);},_handleImage:function(u,s,q){var r=u.alt;var t=u.src;s.push("{{",t);if(r){s.push("|",r);}q.push("}}");},_handleLink:function(s,r,q){var t=s.href;r.push("[[",t,"|");q.push("]]");},_handleListItem:function(w,t,s){var r=this;var q=w.parentNode;var v=q.tagName.toLowerCase();var x=(v===f)?k:a;var u=new Array(r._ulLevel+1);u=u.join(x);if(r._isDataAvailable()&&!r._isLastItemNewLine()){t.push(p);}t.push(u,m);},_handleOrderedList:function(t,s,r){var q=this;q._ulLevel+=1;},_handleParagraph:function(t,s,r){var q=this;if(q._isDataAvailable()){var v=i.exec(q._endResult.slice(-2).join(""));var u=v?v[1].length:0;while(u++<2){s.push(p);}}r.push(p);},_handlePre:function(t,s,r){var q=this;q._inPRE=true;var u=q._endResult;var v=t.innerHTML;if(q._isDataAvailable()&&!q._isLastItemNewLine()){u.push(p);}s.push("{{{",p);r.push("}}}",p);},_handleStrong:function(s,r,q){r.push(h);q.push(h);},_handleStyles:function(r,q,t){var s=r.style;if(s){if(s.fontWeight.toLowerCase()=="bold"){q.push(h);t.push(h);}if(s.fontStyle.toLowerCase()=="italic"){q.push(n);t.push(n);}}},_handleTableCell:function(s,r,q){r.push("|");},_handleTableHeader:function(s,r,q){r.push("|","=");},_handleTableRow:function(t,s,r){var q=this;if(q._isDataAvailable()){s.push(p);}r.push("|");},_handleUnorderedList:function(t,s,r){var q=this;q._ulLevel+=1;},_pushTagList:function(v){var r=this;var t,s,u,q;t=r._endResult;u=v.length;for(s=0;s<u;s++){q=v[s];t.push(q);}}}});d.HTML2CreoleConvertor=o;},"@VERSION@",{requires:["aui-editor-base"]});