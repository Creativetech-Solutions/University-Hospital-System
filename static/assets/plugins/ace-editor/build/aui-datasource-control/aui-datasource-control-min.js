AUI.add("aui-datasource-control-base",function(b){var g=b.Lang,h=g.isFunction,a=g.isString,f="bindUI",c="renderUI",e="syncUI";var d=function(){};d.ATTRS={dataSource:{value:null,setter:function(n){var i=this;var m=n;if(n){var k=m;var l=i.get("dataSourceType");if(!(m instanceof b.DataSource.Local)){if(!l){l="Local";if(h(k)){l="Function";}else{if(a(k)){l="IO";}}}m=new b.DataSource[l]({source:k});}l=m.name;var j=i._schema;if(j){m.plug(j);}i.set("dataSourceType",l);}return m;}},dataSourceType:{value:null},schema:{value:null,lazyAdd:false,setter:function(n){var i=this;var m=i.get("dataSource");var l=i._schema;if(m&&l){m.unplug(l);l=null;i._schema=null;}if(n){if(n.fn){l=n;n=n.cfg.schema;}else{var j=i.get("schemaType");var k={array:b.Plugin.DataSourceArraySchema,json:b.Plugin.DataSourceJSONSchema,text:b.Plugin.DataSourceTextSchema,xml:b.Plugin.DataSourceXMLSchema};j=j.toLowerCase()||"array";l={fn:k[j],cfg:{schema:n}};}}if(m&&l){m.plug(l);}i._schema=l;return n;}},schemaType:{value:"",lazyAdd:false,validator:a}};d.prototype={initializer:function(){var i=this;i.publish(c);i.publish(f);i.publish(e);},renderUI:function(){var i=this;i.fire(c);},bindUI:function(){var i=this;i.publish("dataError");i.publish("dataRequest");i.publish("dataReturn");i.fire(f);},syncUI:function(){var i=this;i.fire(e);}};b.DataSourceControl=d;},"@VERSION@",{requires:["aui-base","datasource","dataschema"]});AUI.add("aui-input-text-control",function(p){var h=p.Lang,k=h.isArray,b=h.isFunction,l=h.isString,n=p.Event.KeyMap,q="alert",c="bindUI",i="content",e="icon",f="list",t="loading",j="renderUI",o="circle-triangle-b",v=q,x=t,u="BACKSPACE",g="TAB",a="ALT",d="WIN_IME",s={node:null,points:["tl","bl"]},w="boundingBox",m="contentBox";var r=function(){var y=this;y.on(j,y._renderUIInputTextControl,y);y.on(c,y._bindUIInputTextControl,y);};r.ATTRS={button:{value:true},delimChar:{value:null,setter:function(y){if(l(y)&&(y.length>0)){y=[y];}else{if(!k(y)){y=p.Attribute.INVALID_VALUE;}}return y;}},forceSelection:{value:false},iconButton:{value:o},input:{value:null},matchKey:{value:0},minQueryLength:{value:1},queryDelay:{value:0.2,getter:function(y){return y*1000;}},queryInterval:{value:0.5,getter:function(y){return y*1000;}},queryMatchCase:{value:false},queryMatchContains:{value:false},queryQuestionMark:{value:true},suppressInputUpdate:{value:false},typeAhead:{value:false},typeAheadDelay:{value:0.2,getter:function(y){return y*1000;}},uniqueName:{value:null}};r.prototype={initializer:function(z){var y=this;y._overlayAlign=p.mix({},s);},_renderUIInputTextControl:function(){var y=this;y._renderInput();},_bindUIInputTextControl:function(){var y=this;y._bindDataSource();var z=y.button;var A=y.inputNode;A.on("blur",y._onTextboxBlur,y);A.on("focus",y._onTextboxFocus,y);A.on("keydown",y._onTextboxKeyDown,y);A.on("keypress",y._onTextboxKeyPress,y);A.on("keyup",y._onTextboxKeyUp,y);y.publish("handleResponse");y.publish("textboxKeyDown");y.publish("textboxKeyPress");y.publish("textboxKeyUp");y.publish("invalidQueryLength");y.publish("sendQueryDisabled");y.publish("containerCollapse");y.publish("containerExpand");y.publish("containerPopulate");y.publish("itemArrowFrom");y.publish("itemArrowTo");y.publish("itemMouseOut");y.publish("itemMouseOver");y.publish("itemSelect");y.publish("selectionEnforce");y.publish("textboxBlur");y.publish("textboxChange");y.publish("textboxFocus");y.publish("textboxKey");y.publish("typeAhead");y.publish("unmatchedItemSelect");},syncUI:function(){var y=this;y.inputNode.setAttribute("autocomplete","off");},doBeforeLoadData:function(y){return true;},formatResult:function(z,A,y){return y||"";},generateRequest:function(y){return{request:y};},handleResponse:function(A){var z=this;z.fire("handleResponse",A);var y=z.get("iconButton")||o;if(A.error){y=v;}z.button.set(e,y);},_bindDataSource:function(){var y=this;var z=y.button;var B=y.get("dataSource");var A=y.get("dataSourceType");B.on("request",p.bind(z.set,z,e,x));B.on("error",y.handleResponse,y);B.after("response",y.handleResponse,y);},_clearInterval:function(){var y=this;if(y._queryIntervalId){clearInterval(y._queryIntervalId);y._queryIntervalId=null;}},_clearSelection:function(){var z=this;var A=z.get("delimChar");var y={previous:"",query:z.inputNode.get("value")};if(A){y=z._extractQuery(z.inputNode.get("value"));}z.fire("selectionEnforce",y.query);},_enableIntervalDetection:function(){var y=this;var z=y.get("queryInterval");if(!y._queryIntervalId&&z){y._queryInterval=setInterval(p.bind(y._onInterval,y),z);}},_extractQuery:function(C){var G=this;var E=G.get("delimChar");var y=-1;var A=E.length-1;var F,D,B;for(;A>=0;A--){F=C.lastIndexOf(E[A]);if(F>y){y=F;}}if(E[A]==" "){for(var z=E.length-1;z>=0;z--){if(C[y-1]==E[z]){y--;break;}}}if(y>-1){D=y+1;while(C.charAt(D)==" "){D+=1;}B=C.substring(0,D);C=C.substring(D);}else{B="";}return{previous:B,query:C};},_focus:function(){var y=this;setTimeout(function(){y.inputNode.focus();},1);},_onButtonMouseDown:function(z){var y=this;z.halt();y._focus();y._sendQuery(y.inputNode.get("value")+"*");},_onInterval:function(){var y=this;var A=y.inputNode.get("value");var z=y._lastValue;if(A!=z){y._lastValue=A;y._sendQuery(A);}},_onTextboxBlur:function(z){var y=this;if(!y._overContainer||n.isKey(y._keyCode,g)){y.fire("textboxBlur");}else{y._focus();}},_onTextboxFocus:function(z){var y=this;if(!y.get("focused")){y.inputNode.setAttribute("autocomplete","off");y.focus();y._initInputValue=y.inputNode.get("value");y.fire("textboxFocus");}},_onTextboxKeyDown:function(z){var y=this;var A=z.keyCode;if(y._typeAheadDelayId!=-1){clearTimeout(y._typeAheadDelayId);}y.fire("textboxKeyDown",z);if(z.isKey(a)){y._enableIntervalDetection();}y._keyCode=A;},_onTextboxKeyPress:function(z){var y=this;y.fire("textboxKeyPress",z);if(z.isKey(d)){y._enableIntervalDetection();}},_onTextboxKeyUp:function(z){var y=this;if(z.isSpecialKey()&&!z.isKey(u)){return;}y.fire("textboxKeyUp",z);},_renderInput:function(){var E=this;var A=E.get(m);var C=E.get("input");var y=E.get("iconButton")||o;
var B={field:{labelText:false},icons:[{icon:y,id:"trigger",handler:{fn:E._onButtonMouseDown,context:E}}]};var F=null;var G=null;if(C){C=p.one(C);B.field.node=C;F=C.next();G=C.get("parentNode");}var D=new p.Combobox(B).render(A);if(G){var z=D.get("boundingBox");G.insertBefore(z,F);}E.inputNode=D.get("node");E.button=D.icons.item("trigger");E.comboBox=D;E.set("uniqueName",p.stamp(E.inputNode));},_sendQuery:function(D){var z=this;if(z.get("disabled")){z.fire("sendQueryDisabled",D);return;}var B=z.get("delimChar");var A=z.get("minQueryLength");if(B){var y=z._extractQuery(D);D=y.query;z._pastSelections=y.previous;}if((D&&(D.length<A))||(!D&&A>0)){z.fire("invalidQueryLength",D);return;}D=encodeURIComponent(D);var E=z.get("dataSource");var C=z.generateRequest(D);z.fire("dataRequest",C);E.sendRequest(C);},_typeAhead:function(z,A){var y=this;if(!y.get("typeAhead")||n.isKey(y._keyCode,u)){return;}var B=p.Node.getDOMNode(y.inputNode);if(B.setSelectionRange||B.createTextRange){y._typeAheadDelayId=setTimeout(function(){var E=B.value;var F=E.length;y._updateValue(z);var C=B.value.length;y.inputNode.selectText(F,C);var D=B.value.substr(F,C);y.fire("typeAhead",A,D);},y.get("typeAheadDelay"));}},_currentQuery:null,_initInputValue:null,_keyCode:null,_lastValue:null,_pastSelections:"",_typeAheadDelayId:-1};p.InputTextControl=r;},"@VERSION@",{requires:["aui-base","aui-datasource-control-base","aui-form-combobox"]});AUI.add("aui-datasource-control",function(a){},"@VERSION@",{use:["aui-datasource-control-base","aui-input-text-control"],skinnable:true});